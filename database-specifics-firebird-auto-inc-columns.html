<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html xmlns:innovasys="" xmlns:mshelp="http://msdn.microsoft.com/mshelp">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta content="history" name="save">
    <meta content="Innovasys Document! X (http://www.innovasys.com)" name="GENERATOR">
    <meta name="ResourceType" content="Documentation" /><meta name="ParentProductId" content="638" /><meta name="ProductId" content="638" /> 
    <title>How to: Manage Auto-Incremental Columns in Firebird</title>
    <link href="stylesheets/helpstudio.css" type="text/css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="stylesheets/customstyles.css"></link>
    <link rel="stylesheet" type="text/css" href="stylesheets/hs-boxes.css"></link>
    <link rel="stylesheet" type="text/css" href="Stylesheets/hs-expandcollapse.css"></link>

    <script src="script/helpstudio.js" type="text/javascript">
</script><script src="script/hs-expandcollapse.js" type="text/javascript"></script>
    <script src="script/hs-enlargeimage.js" type="text/javascript"></script>

</head>

<body id="hsbody">
    

    <div style="DISPLAY: none">
        <input class="userDataStyle" id="userDataCache" type="hidden" name="userDataCache"> <input id="hiddenScrollOffset" type="hidden" name=
        "hiddenScrollOffset">
    </div><img id="collapseImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="images/collapse.gif" name="collapseImage"> <img id="expandImage" style=
    "DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="images/expand.gif" name="expandImage"> <img id="copyImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px"
    src="images/copycode.gif" name="copyImage"> <img id="copyHoverImage" style="DISPLAY: none; WIDTH: 0px; HEIGHT: 0px" src="images/copycodeHighlight.gif"
    name="copyHoverImage">

    <div id="pagetop">
        

        <table id="pagetoptable1" width="100%">
            <tbody>
                <tr id="pagetoptable1row1">
                    <td align="left"><span id="projecttitle">Telerik OpenAccess ORM</span></td>

                    <td align="right"><span id="feedbacklink"><a href="mailto:documentation@telerik.com?subject=Documentation Feedback:Telerik OpenAccess ORM-database-specifics-firebird-auto-inc-columns">Send comments</a> on this topic.</span></td>
                </tr>

                <tr id="pagetoptable1row2">
                    <td align="left" colspan="2"><span id="pagetitle">How to: Manage Auto-Incremental Columns in Firebird</span></td>
                </tr>
                
			</tbody>
        </table><table width="100%" id="pagetopbreadcrumbs" cellspacing="0" cellpadding="0"><tr><td>
Programmer's Guide > Developer's Guide > <a href="database-specifics-overview.html">Database Specifics</a> > <a href="database-specifics-firebird-overview.html">Firebird</a> > How to: Manage Auto-Incremental Columns in Firebird</td></tr></table>
    </div>

    <div class="hspopupbubble" id="hsglossaryitembox">
        <p>Glossary Item Box</p>
    </div>

    <div id="pagebody">
        <div id="mainbody">
            <P>The purpose of this topic is to illustrate how to manage auto-incremental columns in&nbsp;Firebird with Telerik OpenAccess ORM. The autoinc mechanism in Firebird is based on <STRONG>generators</STRONG> and <STRONG>triggers</STRONG>. If you have a table in&nbsp;Firebird database whose primary key column is filled by a unique Firebird generator, OpenAccess ORM can automatically detect that the table has a server side generated primary key mechanism.</P>
<H1>Database First Scenario</H1>
<P>Suppose, you have the following&nbsp;Firebird table, generator and trigger.</P>
<P><IMG border=0 alt="" src="images/1DatabaseSupport-Firebird-AutoInc-005.png">&nbsp;</P>
<P>The table is named <STRONG>TASK </STRONG>and contains three columns. </P>
<P>The generator is used to populate automatically the primary key column (the ID column). For example:</P>
<DIV id=Syntax_T-SQL class=LanguageSpecific>
<TABLE class=syntaxtable cellSpacing=0 cellPadding=0 width="100%">
<TBODY>
<TR>
<TH>SQL</TH>
<TH><SPAN class=hs-onlineonly><SPAN class=copyCode onfocusin=changeCopyCodeIcon(this,true) onmouseover=changeCopyCodeIcon(this,true) onfocusout=changeCopyCodeIcon(this,false) tabIndex=0 onkeypress=CopyCode_CheckKey(this) onmouseout=changeCopyCodeIcon(this,false) onclick=copyCode(this)><IMG class=copyCodeImage name=ccImage align=absMiddle src="images/copycode.gif">Copy Code</SPAN></SPAN></TH></TR>
<TR>
<TD colSpan=2>
<DIV class=colorizedcode><FONT color=blue>CREATE</FONT> <FONT color=black>GENERATOR TASK_SEQ;<BR></FONT><FONT color=blue>SET</FONT> <FONT color=black>GENERATOR TASK_SEQ</FONT> <FONT color=blue>TO</FONT> <FONT color=black>9999999;</FONT></DIV></TD></TR></TBODY></TABLE></DIV>
<P>And you have a <STRONG>before</STRONG> <STRONG>insert</STRONG> trigger that set the value of the ID column by using the created Firebird generator. For example:</P>
<DIV id=Syntax_SQL class=LanguageSpecific>
<TABLE class=syntaxtable cellSpacing=0 cellPadding=0 width="100%">
<TBODY>
<TR>
<TH>SQL</TH>
<TH><SPAN class=hs-onlineonly><SPAN class=copyCode onfocusin=changeCopyCodeIcon(this,true) onmouseover=changeCopyCodeIcon(this,true) onfocusout=changeCopyCodeIcon(this,false) tabIndex=0 onkeypress=CopyCode_CheckKey(this) onmouseout=changeCopyCodeIcon(this,false) onclick=copyCode(this)><IMG class=copyCodeImage name=ccImage align=absMiddle src="images/copycode.gif">Copy Code</SPAN></SPAN></TH></TR>
<TR>
<TD colSpan=2>
<DIV class=colorizedcode><FONT color=blue>CREATE</FONT> <FONT color=black>TRIGGER TASKS_BI</FONT> <FONT color=blue>FOR</FONT> <FONT color=black>TASKS<BR>ACTIVE BEFORE</FONT> <FONT color=blue>INSERT<BR>POSITION</FONT> <FONT color=black>0<BR></FONT><FONT color=blue>AS<BR>BEGIN<BR>&nbsp;</FONT><FONT color=black>if (NEW.ID</FONT> <FONT color=blue>IS</FONT> <FONT color=blue>NULL</FONT><FONT color=black>)</FONT> <FONT color=blue>THEN</FONT> <FONT color=black>NEW.ID</FONT> <FONT color=red>=</FONT> <FONT color=black>GEN_ID(TASK_SEQ, 1);<BR></FONT><FONT color=blue>END</FONT></DIV></TD></TR></TBODY></TABLE></DIV>
<P>When you create a new domain model, OpenAccess ORM will automatically detect that a server side primary key mechanism is used. Each time when you insert a new object runtime, OpenAccess will use the&nbsp;generated ID value to maintain the object identity. The Id column will be omitted from the generated insert statement and the value that has been generated by the&nbsp;generator will be obtained.</P>
<P><IMG border=0 alt="" src="images/1DatabaseSupport-Firebird-AutoInc-010.png"></P>
<DIV style="WIDTH: 100%">
<TABLE class=hs-box>
<TBODY>
<TR>
<TD class=hs-box-icon vAlign=top><IMG src="images/hs-note.gif"></TD>
<TD class=hs-box-content vAlign=top>OpenAccess ORM looks only for <STRONG>Before Insert</STRONG> triggers. All other types of triggers (After Insert, Before Update, After Update, Before Delete and After Delete) will be ignored, i.e. the Identity Mechanism will not be set to DatabaseServerCalculated and the Id column will be included in the generated insert statement).</TD></TR></TBODY></TABLE></DIV>
<H1>Model First Scenario</H1>
<P>If your entity has an <STRONG><A href="http://msdn.microsoft.com/en-us/library/exx3b86w.aspx">integral</A> (int, long, byte, short, uint, ulong, ubyte, ushort)</STRONG>, <STRONG>double</STRONG> or <STRONG>float</STRONG> identity and the <STRONG>Identity Mechanism</STRONG> is set to <STRONG>DatabaseServerCalculated</STRONG>, the generated DDL script will add all necessary elements in the database schema to have a working autoinc setup.</P>
<P>The generated&nbsp;generator and trigger will have the following name format: "Gen_TableName_ColumnName" and "Trg_TableName_ColumnName".</P>
<P>For example, if your entity is named TASK and the primary key property is named ID, the generated trigger and&nbsp;generator will be:</P>
<DIV id=Syntax_SQL class=LanguageSpecific>
<TABLE class=syntaxtable cellSpacing=0 cellPadding=0 width="100%">
<TBODY>
<TR>
<TH>SQL</TH>
<TH><SPAN class=hs-onlineonly><SPAN class=copyCode onfocusin=changeCopyCodeIcon(this,true) onmouseover=changeCopyCodeIcon(this,true) onfocusout=changeCopyCodeIcon(this,false) tabIndex=0 onkeypress=CopyCode_CheckKey(this) onmouseout=changeCopyCodeIcon(this,false) onclick=copyCode(this)><IMG class=copyCodeImage name=ccImage align=absMiddle src="images/copycode.gif">Copy Code</SPAN></SPAN></TH></TR>
<TR>
<TD colSpan=2>
<DIV class=colorizedcode><FONT color=blue>CREATE</FONT> <FONT color=black>GENERATOR</FONT> <FONT color=purple>"Gen_TASK_ID"</FONT><FONT color=black>;<BR></FONT><FONT color=blue>SET</FONT> <FONT color=black>GENERATOR</FONT> <FONT color=purple>"Gen_TASK_ID"</FONT> <FONT color=blue>TO</FONT> <FONT color=black>0;<BR></FONT><FONT color=blue>CREATE</FONT> <FONT color=black>TRIGGER</FONT> <FONT color=purple>"Trg_TASK_ID"</FONT> <FONT color=blue>FOR</FONT> <FONT color=purple>"TASK"<BR></FONT><FONT color=black>ACTIVE BEFORE</FONT> <FONT color=blue>INSERT</FONT> <FONT color=blue>POSITION</FONT> <FONT color=black>0</FONT> <FONT color=blue>AS<BR>BEGIN<BR></FONT><FONT color=black>IF (NEW.</FONT><FONT color=purple>"ID"</FONT> <FONT color=blue>IS</FONT> <FONT color=blue>NULL</FONT><FONT color=black>)</FONT> <FONT color=blue>THEN</FONT> <FONT color=black>NEW.</FONT><FONT color=purple>"ID"</FONT> <FONT color=red>=</FONT> <FONT color=black>GEN_ID(</FONT><FONT color=purple>"Gen_TASK_ID"</FONT><FONT color=black>, 1);<BR></FONT><FONT color=blue>END</FONT><FONT color=black>;</FONT></DIV></TD></TR></TBODY></TABLE></DIV>
<P>If you modify the <STRONG>Identity</STRONG> <STRONG>Mechanism</STRONG> of an entity from <STRONG>DatabaseServerCalculated</STRONG> to <STRONG>Default</STRONG> and migrate your database, OpenAccess ORM will generate DDL for <STRONG>dropping</STRONG> <STRONG>the</STRONG> <STRONG>trigger only</STRONG>. Respectively, if you modify the <STRONG>Identity</STRONG> <STRONG>Mechanism</STRONG> of an entity from <STRONG>Default</STRONG> to <STRONG>DatabaseServerCalculated</STRONG> and migrate your database, OpenAccess ORM will generate a trigger and a default generator. If a&nbsp;generator with the same name already exists, OpenAccess ORM will use that generator in the trigger and will not attempt to create a new generator.</P> <a id="seealsobookmark" name="seealsobookmark"></a>
            
        </div>

        <div id="pagefooter">
            <p>&nbsp;</p><p>&nbsp;</p><hr style="height: 1px" /><p>&copy; 2002-2012 Telerik. All Rights Reserved.</p>
        </div>
    </div>
</body>
</html>